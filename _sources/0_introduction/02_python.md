# Python

## About Python Language

ここでは神経科学における解析に話を限定します．神経科学で取得される主なデータは電気信号ということもあり，信号処理に適した代表的な言語として**MATLAB**がよく使われている印象です．しかし，最近ではデータセットの質と精度の向上に伴う機械学習・統計処理分野の発展もあり，**Python**も増えてきている印象です（2023 年 執筆現在）．

私の狭い知識では心許ないので，ChatGPT に訊いてみました．

```{admonition} ChatGPT
> **MATLAB vs Python for neuroscience?**

MATLAB と Python はどちらも神経科学研究で広く使われており、どちらにも利点と欠点があります。MATLAB は、ユーザーフレンドリーな GUI と豊富なツールボックスを備え、神経データ解析のための標準的なツールです。一方、Python は、その柔軟性、利用可能なライブラリの多さ、オープンソースの性質から、ますます人気が高まっています。Python は神経科学者やデータサイエンティストのコミュニティが拡大しており、それ以外でも、特に産業界や機械学習で広く利用されています。最終的に、MATLAB と Python のどちらを選ぶかは、あなたの研究ニーズや好みによります。
```

とはいえ真理はきっと最後の一文なのでしょう．好みに応じて決めるのが私もよいと思います．

## Environment Setup

### 仮想環境

Python では様々なライブラリをインストールし，import して使うことになるため，仮想環境によりライブラリ空間をプロジェクトごとに分離することが望ましいです．

以下は Python 標準の venv を用いて仮想環境を管理する例．

1. プロジェクトの仮想環境作成:

   ```shell
   $ mkdir [PROJECT DIRECTORY]
   $ cd [PROJECT DIRECTORY]
   $ python3 -m venv [NEW ENV NAME]
   ```

   ```{tip}
   [NEW ENV NAME]はプロジェクトに関係なく一貫して`venv`に統一するのがオススメ．すなわち `$ python3 -m venv venv`で統一する．以降のコードは，これにしたがうとする．
   ```

2. 仮想環境のアクティベーション:

   ```shell
   $ . venv/bin/activate

   (venv) $ which python
   ~/[PROJECT DIRECTORY]/venv/bin/python
   ```

3. ライブラリのインストール:

   ```shell
   (venv) $ pip install [package name]
   ```

4. スクリプトの実行など:
   ```shell
   (venv) $ python3 script.py
   ```

## Tools

### Git

Git は，ファイルの変更履歴を記録するバージョン管理ツール．これにより，プロジェクトのファイル群（レポジトリ）を複数のユーザーが別々に編集した上で，のちに差分を統合することができる．チームによるソフトウェア開発では必ずといっていいほど使われる．

Git において最低限押さえておくと良い概念をいくつか述べます．

```{important}
- **local / remote（ローカル / リモート）**
  - 手元の PC 内にある環境がローカル．ローカルにあるレポジトリを他のユーザーとかがアクセスできるようにサーバー上に置いている場所がリモート．リモートレポジトリをホストする代表的なサービスとして **Github** がある．
- **commit（コミット）**
  - ファイルに加えた変更（差分）のスナップショットを取ること．多くの場合，「機能 A を加えた」「〇〇のバグを修正した」等のファイルに対する変更が何らかの意味をもつような粒度で，変更を記録していくイメージ．
- **branch（ブランチ）**
  - 元のレポジトリのコピーを並列に保持したまま，新しい機能を追加してテストしたり，A さん・B さんで別々にブランチを切って後でメインのブランチに統合する等，共同編集・チーム開発に特化したバックアップシステムのようなもの．
- **clone（クローン）**
  - リモートレポジトリを，ローカルにコピーしてくることです．
- **push / fetch（プッシュ / フェッチ）**
  - ここでは非常にラフな説明にとどめますが，プッシュはローカルの変更をリモートに反映すること（自分から他ユーザーへの共有に繋がる），フェッチはリモートの変更を ローカルに取ってくること（他ユーザーから自分への共有）です．
- **merge / pull（マージ / プル）**
    - マージは，他のブランチを現在のブランチに統合することです（つまり他のブランチに加えられたファイルの変更が現在のブランチに適応される）．プルは，fetch + mergeのことで，リモートブランチの変更をローカルに取ってきた上で，現在のブランチに統合することです．
```

MEA Book のノートブック一覧を丸ごとローカルにコピーして走らせたい方は，次のように Github からクローンしてください．CLI や Git が苦手な方は，Github から Download ZIP もできます．

```shell
$ git clone https://github.com/tk-neuron/meabook.git
```

また，**Contribution**（寄稿）してくださる方を積極的に募集しています．基本的にはプルリクエストを通じて行ってくださると助かりますが，小さな提案の場合は Github の機能である Issue を通じて送ってくださるのも歓迎です．

以下にプルリクエスト作成までの大まかな流れを紹介します．まず，上記の手順でレポジトリをクローンした後，次のように新しいブランチを切って移動してください．ブランチ名には追加したい機能の名前を含めることが多いです．

```shell
$ git checkout -b [feature/XXX]
```

新しいノートブックを追加したり，既存のファイルを変更したりして編集が済んだら，コミットしてください．

```shell
$ git add -p [file name]
$ git commit -m [commit message]
```

コミットが蓄積してブランチが仕上がったら，次のようにブランチの先頭をプッシュしてください．

```shell
$ git push origin HEAD
```

すると，Github 上で先ほどプッシュしたブランチに紐づくプルリクエストが編集できるようになります．プルリクエストとは，変更の内容をまとめて，ブランチを統合するためのリクエストを送っていただくものです．プロジェクトのオーナーはプルリクエストをレビューし，内容が問題ない場合はメインのブランチに統合され，今回の場合は Web ページに提案された変更内容が反映されます．

### Google Colaboratory (Colab)

Google のサーバー上に構築された Jupyter 環境に無料でアクセスできるツールで，Python による解析が環境構築不要で行えます．定番のライブラリ群はすでにインストールされているため（本ノートブックのライブラリは全て網羅されていると思われます），Python・環境構築に慣れていない方はまずこちらから始めてみるのも良さそうです．

各ノートブックの右上に，Open Colaboratory というボタンがありますので，それをクリックしていただくと，Colab のページ が開き，すぐに解析を始めることができます．

データのやり取りは，Google Drive を通じて行います．本ノートブックでもサンプルデータを用いて解析を行うため，詳しくは次章 {doc}`03_datasets`を参照してください．
